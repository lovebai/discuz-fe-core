# 使用问题

### 微信内访问提示错误码：`40164`

- 访问 **公众号管理后台-开发-基本配置**，在 **公众号开发信息** 下面的**IP白名单** 中增加当前网站服务器的IP

&emsp;

### 微信内访问提示：`redirect_uri`域名与后台配置不一致，错误码:`10003`

- 访问 **公众号管理后台-开发-接口权限-网页授权** ，修改网页授权，增加当前网站的域名

&emsp;

### 微信内访问提示：`redirect_uri`域名与后台配置不一致，错误码:`10039`

- **公众号设置--功能设置**：业务域名和网页授权域名都不能绑定两个以上任何几级域名；JS接口安全域名可以绑定两个以上域名；

&emsp;

### H5访问页面提示错误码：`40125`

- 访问Discuz! Q后台，在**全局-微信设置-公众号接口配置** 中配置下 `APPID` 和 `App secret` ，然后开启即可，如果开启后依然有问题，尝试去公众号后台重置下`App secret`

&emsp;

### 小程序访问提示：`request：fail`

- 访问 **小程序管理后台-开发-开发设置**，在 **服务器域名** 下面的 **request合法域名** 中填写当前网站URL

&emsp;

### 在微信内进行支付时提示：当前页面的URL未注册:URL地址xxx

- 登录微信商户平台，在**产品中心-开发配置** 中配置下JSAPI支付和H5支付的域名

&emsp;

### 在微信内进行支付时提示：签名错误

- 登录微信商户平台，使用**账户中心-API安全-API密钥** ，配置**后台-支付设置-微信支付** 里的APIKEY

&emsp;

### 获取短信验证码时提示：`package format error, template params error`

- 短信模板有误，备案时短信模板必须为2个参数，模板参考：{参数1}为您的验证码，请于{参数2}分钟内填写。如非本人操作，请忽略本短信。

&emsp;

### 上传图片时，一直显示"图片上传中..."或上传失败

- 尝试修改`php.ini`，把`memory_limit`参数适当调大，`nginx`的`client_max_body_size`的参数适当调大，并重启`PHP`和`nginx`服务

&emsp;

### 前后台页面底部的 POWER BY Discuz! Q 可不可以去掉？

- 理论上，根据Apache Licese 2.0开源协议，可以去掉。但请大家尊重Discuz! Q 团队的劳动成果。

&emsp;

### 小程序端打开Q站点使用微信无感注册的账号和h5微信注册的用户名不统一

- 需要在 [微信开放平台](https://open.weixin.qq.com/) 关联公众号和小程序的appid，生成唯一的用户标识`unionId`；
`unionId`的机制说明：[UnionID 机制说明](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/union-id.html)；
如果在开放平台完成绑定操作后依然无法统一账户，用户需要在论坛先解绑微信之后重新绑定

&emsp;

### 后台提现审核失败，已开启支付设置的企业付款到零钱

1.检查商户后台是否真正的开通了企业付款到零钱功能并且运营账户是否余额充足；
2.支付相关证书有没有上传到文件夹 项目根目录 `/storage/cert`

&emsp;

### 手机获取验证码后提交提示 “手机号发送接口异常”

- 检查腾讯云短信服务是否过期，检查短信模板签名，变量是否设置正常

&emsp;

### 软链接失效

【Linux服务器】

- `ln -s` 安装目录`/storage/app/public` 安装目录`/public/storage`
比如站点安装目录的绝对路径是：
`/www/wwwroot/discuz.chat`
那么这条命令就是：
`ln -s /www/wwwroot/discuz.chat/storage/app/public /www/wwwroot/discuz.chat/public/storage`

【Windows服务器】

- `mklink /j` 安装目录`/public/storage` 安装目录`/storage/app/public`
比如站点安装目录的绝对路径是：
`c:\wwwroot\discuz.chat`
那么这条命令就是：
`mklink /j c:\wwwroot\discuz.chat\public\storage c:\wwwroot\discuz.chat\storage\app\public`

&emsp;

### 0624版本注册新用户会出现 “网络错误”

- 后台 **注册设置** 密码强度默认未设置，重新设置下提交

&emsp;

### PC微信登录生成小程序二维码失败

- 第三方登录设置 **关闭小程序** ，等发布成功3，0小程序再开启

&emsp;

### 配置完云点播之后，发帖上传视频一直转码中

- 检查云点播转码模板、防盗链，回调校验码等配置是否设置正确

&emsp;

### 在线支付输入支付密码后微信提示 “支付失败，请稍后再试”

- 检查后台支付设置的参数有无空格，检查商户号后台开发配置域名是否统一

&emsp;

### 微信支付时提示 “错误的签名，验签失败”

- 检查后台支付设置的`api`密钥（`key`）是否设置正确

&emsp;

### 发帖或修改个人信息时提示 “未开通权限”

- 关闭后台腾讯云里的图片内容安全和文本内容安全，若要使用，请先去腾讯云开通服务后，再开启后台的开关

&emsp;

### 开启cos(对象存储)之后，旧帖子附件下载下来大小为0kb

- 旧帖子附件文件夹需上传到cos的同名文件夹下，并重新执行软链接命令

&emsp;

### 开启cos之后，上传图片总是容易出现网络错误

- 对象存储和服务器所在地区保持一致

&emsp;

### 发送短信验证码时提示 `time offset too big...`

- 检查服务器系统时间和所在地区网络时间是否一致

&emsp;

### 新用户注册提示 “用户名注册接口异常”

- 后台腾讯云设置，关闭图片/文本内容安全，若要开启请先到腾讯云购买相应资源包开通服务

&emsp;

### 定位地图页面出现  “获取消息列表失败”

- 腾讯位置服务控制台，`WebServiceAPI`域名白名单留空

&emsp;

### 微信支付时报错：time_expire时间过短，刷卡至少1分钟，其他5分钟

- 检查下服务器时间和网络时间是否一致

&emsp;

### 插入上传图片时，提示 “上传失败：未获取到文件信息！”

- 检查腾讯云对象存储cos的读写权限，若后台启用了签名，设置为私有读写；关闭了签名，设置为公有都私有写
